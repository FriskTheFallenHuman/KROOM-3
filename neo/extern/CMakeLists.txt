project(external)

set(src_external)
set(src_external_includes)

file(GLOB src_external_miniz miniz/*.c miniz/*.h)
source_group("Miniz" FILES ${src_external_miniz})
list(APPEND src_external ${src_external_miniz})
list(APPEND src_external_includes ${CMAKE_CURRENT_SOURCE_DIR}/miniz)
#always_optimize_sourcefile(miniz/miniz.c)

file(GLOB src_external_minizip minizip/*.cpp minizip/*.c minizip/*.h)
source_group("Minizip" FILES ${src_external_minizip})
list(APPEND src_external ${src_external_minizip})
list(APPEND src_external_includes ${CMAKE_CURRENT_SOURCE_DIR}/minizip)
#always_optimize_sourcefile(minizip/ioapi.c)
#always_optimize_sourcefile(minizip/unzip.cpp)

if(BINKDEC)
file(GLOB src_external_binkdec libbinkdec/src/*.cpp libbinkdec/src/*.c libbinkdec/include/*.h)
source_group("BinkDec" FILES ${src_external_binkdec})
list(APPEND src_external ${src_external_binkdec})
list(APPEND src_external_includes ${CMAKE_CURRENT_SOURCE_DIR}/libbinkdec/include)
endif()

file(GLOB src_external_mikktspace mikktspace/*.c mikktspace/*.h)
source_group("MikktSpace" FILES ${src_external_mikktspace})
list(APPEND src_external ${src_external_mikktspace})

file(GLOB src_external_mesa mesa/*.h)
source_group("Mesa" FILES ${src_external_mesa})
list(APPEND src_external ${src_external_mesa})

file(GLOB src_external_imgui imgui/*.cpp imgui/*.h)
source_group("ImGUI" FILES ${src_external_imgui})
list(APPEND src_external ${src_external_imgui})

if(NOT USE_VULKAN)
file(GLOB src_external_glew glew/src/*.c glew/include/GL/*.h)
list(REMOVE_ITEM src_external_glew ${CMAKE_CURRENT_SOURCE_DIR}/glew/src/visualinfo.c)
if(WIN32)
list(REMOVE_ITEM src_external_glew ${CMAKE_CURRENT_SOURCE_DIR}/glew/include/GL/glxew.h)
else()
list(REMOVE_ITEM src_external_glew ${CMAKE_CURRENT_SOURCE_DIR}/glew/include/GL/wglew.h)
endif()
source_group("Glew" FILES ${src_external_glew})
list(APPEND src_external ${src_external_glew})
list(APPEND src_external_includes ${CMAKE_CURRENT_SOURCE_DIR}/glew/include)
else()
file(GLOB src_external_vma vma/*.cpp vma/*.h)
source_group("VMA" FILES ${src_external_vma})
list(APPEND src_external ${src_external_vma})
endif()

file(GLOB src_external_stb stb/*.h stb/*.c)
source_group("Stb" FILES ${src_external_stb})
list(APPEND src_external ${src_external_stb})

file(GLOB src_external_tinyexr tinyexr/*.h)
source_group("TinyEXR" FILES ${src_external_tinyexr})
list(APPEND src_external ${src_external_tinyexr})

add_library(${PROJECT_NAME} STATIC ${src_external})
target_compile_definitions(${PROJECT_NAME} PRIVATE GLEW_STATIC)
target_include_directories(${PROJECT_NAME} PRIVATE ${src_external_includes})